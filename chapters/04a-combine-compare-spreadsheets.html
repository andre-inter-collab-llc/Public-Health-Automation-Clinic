<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Combine and Compare Spreadsheets – Public Health Automation Clinic</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/05-data-analysis-reporting.html" rel="next">
<link href="../chapters/04-data-cleaning-transformation.html" rel="prev">
<link href="../assets/branding/icons/intesect icon v1.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8caf6eaa0938078aad3b4e3e78d03e50.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-391dc9eaa9d5ee7385b50e8209b8eefe.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8caf6eaa0938078aad3b4e3e78d03e50.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-14f82c463c8fe26062a60e93003a4987.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-31e31e4e7d1317add0186254dcf5e9b9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-14f82c463c8fe26062a60e93003a4987.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(../assets/branding/images/cover-image.jpg);
background-size: cover;
      }
</style>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/04-data-cleaning-transformation.html">Data Cleaning and Transformation</a></li><li class="breadcrumb-item"><a href="../chapters/04a-combine-compare-spreadsheets.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Combine and Compare Spreadsheets</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/04-data-cleaning-transformation.html">Data Cleaning and Transformation</a></li><li class="breadcrumb-item"><a href="../chapters/04a-combine-compare-spreadsheets.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Combine and Compare Spreadsheets</span></a></li></ol></nav>
      <div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Combine and Compare Spreadsheets</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets\branding\logos\intesect_logo_v1.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../assets\branding\logos\intesect_logo_v1.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Public Health Automation Clinic</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Public Health Automation Clinic</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">The Clinic</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-automation-intake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Automation Clinic</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Desktop Automation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-desktop-automation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Desktop Automation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Access and Integration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-data-access-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Access and Integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Cleaning and Transformation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-data-cleaning-transformation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Cleaning and Transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04a-combine-compare-spreadsheets.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Combine and Compare Spreadsheets</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Analysis and Reporting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-data-analysis-reporting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Analysis and Reporting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Business Process Automation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-business-process-automation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Business Process Automation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">The Automation Mindset</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-from-manual-to-automated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">From Manual to Automated</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-community-of-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Building a Community of Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-automation-education.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Automation and Public Health Education</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A-tool-recommendations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Tool Recommendations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/B-submission-templates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Submission Templates and Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/D-development-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Development Tools and AI Transparency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/C-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-problem" id="toc-the-problem" class="nav-link active" data-scroll-target="#the-problem"><span class="header-section-number">7</span> The Problem</a>
  <ul>
  <li><a href="#the-scale-of-the-problem" id="toc-the-scale-of-the-problem" class="nav-link" data-scroll-target="#the-scale-of-the-problem"><span class="header-section-number">7.1</span> The Scale of the Problem</a></li>
  </ul></li>
  <li><a href="#the-solution" id="toc-the-solution" class="nav-link" data-scroll-target="#the-solution"><span class="header-section-number">8</span> The Solution</a>
  <ul>
  <li><a href="#why-this-app-exists" id="toc-why-this-app-exists" class="nav-link" data-scroll-target="#why-this-app-exists"><span class="header-section-number">8.1</span> Why This App Exists</a></li>
  <li><a href="#why-local-first-sharing" id="toc-why-local-first-sharing" class="nav-link" data-scroll-target="#why-local-first-sharing"><span class="header-section-number">8.2</span> Why Local-First Sharing?</a></li>
  <li><a href="#user-story" id="toc-user-story" class="nav-link" data-scroll-target="#user-story"><span class="header-section-number">8.3</span> User Story</a></li>
  <li><a href="#gps-given-person-should" id="toc-gps-given-person-should" class="nav-link" data-scroll-target="#gps-given-person-should"><span class="header-section-number">8.4</span> GPS (Given-Person-Should)</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">9</span> Getting Started</a>
  <ul>
  <li><a href="#download-the-app" id="toc-download-the-app" class="nav-link" data-scroll-target="#download-the-app"><span class="header-section-number">9.1</span> Download the App</a></li>
  <li><a href="#install-requirements" id="toc-install-requirements" class="nav-link" data-scroll-target="#install-requirements"><span class="header-section-number">9.2</span> Install Requirements</a></li>
  <li><a href="#run-the-app" id="toc-run-the-app" class="nav-link" data-scroll-target="#run-the-app"><span class="header-section-number">9.3</span> Run the App</a></li>
  </ul></li>
  <li><a href="#how-to-use-the-app" id="toc-how-to-use-the-app" class="nav-link" data-scroll-target="#how-to-use-the-app"><span class="header-section-number">10</span> How to Use the App</a>
  <ul>
  <li><a href="#step-1-upload-files" id="toc-step-1-upload-files" class="nav-link" data-scroll-target="#step-1-upload-files"><span class="header-section-number">10.1</span> Step 1: Upload Files</a></li>
  <li><a href="#step-2-select-sheet-name" id="toc-step-2-select-sheet-name" class="nav-link" data-scroll-target="#step-2-select-sheet-name"><span class="header-section-number">10.2</span> Step 2: Select Sheet Name</a></li>
  <li><a href="#step-3-set-the-header-row" id="toc-step-3-set-the-header-row" class="nav-link" data-scroll-target="#step-3-set-the-header-row"><span class="header-section-number">10.3</span> Step 3: Set the Header Row</a></li>
  <li><a href="#step-4-process-files" id="toc-step-4-process-files" class="nav-link" data-scroll-target="#step-4-process-files"><span class="header-section-number">10.4</span> Step 4: Process Files</a></li>
  <li><a href="#step-5-review-results" id="toc-step-5-review-results" class="nav-link" data-scroll-target="#step-5-review-results"><span class="header-section-number">10.5</span> Step 5: Review Results</a>
  <ul>
  <li><a href="#combined-data" id="toc-combined-data" class="nav-link" data-scroll-target="#combined-data"><span class="header-section-number">10.5.1</span> Combined Data</a></li>
  <li><a href="#column-comparison" id="toc-column-comparison" class="nav-link" data-scroll-target="#column-comparison"><span class="header-section-number">10.5.2</span> Column Comparison</a>
  <ul class="collapse">
  <li><a href="#discrepancies-only" id="toc-discrepancies-only" class="nav-link" data-scroll-target="#discrepancies-only"><span class="header-section-number">10.5.2.1</span> Discrepancies Only</a></li>
  <li><a href="#full-matrix" id="toc-full-matrix" class="nav-link" data-scroll-target="#full-matrix"><span class="header-section-number">10.5.2.2</span> Full Matrix</a></li>
  <li><a href="#file-profiles" id="toc-file-profiles" class="nav-link" data-scroll-target="#file-profiles"><span class="header-section-number">10.5.2.3</span> File Profiles</a></li>
  </ul></li>
  <li><a href="#file-issues" id="toc-file-issues" class="nav-link" data-scroll-target="#file-issues"><span class="header-section-number">10.5.3</span> File Issues</a></li>
  <li><a href="#explore-data" id="toc-explore-data" class="nav-link" data-scroll-target="#explore-data"><span class="header-section-number">10.5.4</span> Explore Data</a></li>
  </ul></li>
  <li><a href="#step-6-download" id="toc-step-6-download" class="nav-link" data-scroll-target="#step-6-download"><span class="header-section-number">10.6</span> Step 6: Download</a></li>
  </ul></li>
  <li><a href="#supported-file-formats" id="toc-supported-file-formats" class="nav-link" data-scroll-target="#supported-file-formats"><span class="header-section-number">11</span> Supported File Formats</a></li>
  <li><a href="#tips-and-best-practices" id="toc-tips-and-best-practices" class="nav-link" data-scroll-target="#tips-and-best-practices"><span class="header-section-number">12</span> Tips and Best Practices</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="the-problem" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> The Problem</h1>
<p>Public health teams frequently distribute Excel-based data collection forms to multiple sites, facilities, or respondents. A common workflow looks like this: a program coordinator creates a standardized spreadsheet template, emails it to ten county offices, and asks each office to fill in their data and return it. Sometimes the spreadsheets are stored in a shared folder instead. Either way, the coordinator eventually needs to combine all responses into a single dataset for analysis.</p>
<p>This process breaks down in predictable ways:</p>
<ul>
<li><strong>Column headers get renamed.</strong> One site changes “date_of_diagnosis” to “dx_date.” Another adds a space. A third capitalizes it differently.</li>
<li><strong>Columns are added or removed.</strong> A site inserts an extra column for local tracking, or deletes a column they consider irrelevant.</li>
<li><strong>Sheet names differ.</strong> The template uses “Data Entry” but a respondent renames the tab to “Sheet1.”</li>
<li><strong>Manual merging is tedious and error-prone.</strong> Copy-pasting rows from ten spreadsheets into a master file can take hours and risks misaligned columns, dropped records, or duplicated data.</li>
</ul>
<p>The coordinator may then try to analyze the combined data in Excel or R, only to discover that the structural inconsistencies have created problems downstream: mismatched column counts, unexpected blanks, or silently misaligned values.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Why Not Use a Proper Data Collection Tool?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Why Not Use a Proper Data Collection Tool?
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have the option, a structured data collection platform like <a href="https://www.project-redcap.org/" target="_blank">REDCap</a>, <a href="https://www.kobotoolbox.org/" target="_blank">KoBoToolbox</a>, or even <a href="https://www.google.com/forms/about/" target="_blank">Google Forms</a> is almost always preferable to distributing Excel templates. These tools enforce field types, validation rules, and consistent structure at the point of entry, eliminating the column mismatch problem entirely.</p>
<p>However, many public health teams still end up with spreadsheets for practical reasons:</p>
<ul>
<li><strong>No access to REDCap or similar tools.</strong> Not every organization has a REDCap instance, and setting one up requires server infrastructure and IRB coordination.</li>
<li><strong>Speed of setup.</strong> Creating an Excel template and emailing it takes minutes. Configuring a REDCap instrument with branching logic and validation can take days.</li>
<li><strong>Existing systems export spreadsheets.</strong> Cancer registries, laboratory information systems, EHR extracts, and surveillance platforms often produce Excel or CSV exports as their standard output format. The data was never “collected” in a spreadsheet; it was generated by another system.</li>
<li><strong>External partners use Excel.</strong> When collecting data from facilities, providers, or agencies outside your organization, you often cannot dictate the tool. You get what you get.</li>
<li><strong>One-time or ad-hoc collections.</strong> For a quick data call that will only happen once, the overhead of setting up a formal data collection instrument may not be justified.</li>
</ul>
<p>This tool is designed for those situations: when spreadsheets are the reality, whether by choice or by circumstance.</p>
</div>
</div>
<section id="the-scale-of-the-problem" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="the-scale-of-the-problem"><span class="header-section-number">7.1</span> The Scale of the Problem</h2>
<p>Consider a state cancer registry that collects annual data submissions from 88 county health departments using a standardized Excel template. Each year, staff must:</p>
<ol type="1">
<li>Download or receive 88 completed workbooks</li>
<li>Open each one to verify the correct sheet exists</li>
<li>Check that column headers match the template</li>
<li>Copy and paste (or append) the data into a master file</li>
<li>Troubleshoot the files that do not match</li>
</ol>
<p>At 5 to 10 minutes per file, this is 7 to 15 hours of manual work, repeated every reporting cycle. And that estimate assumes nothing goes wrong.</p>
</section>
</section>
<section id="the-solution" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> The Solution</h1>
<p>The <strong>Combine &amp; Compare Spreadsheets</strong> app is a Shiny web application that automates this entire workflow. Upload your spreadsheets, click a button, and get:</p>
<ul>
<li>A <strong>combined dataset</strong> with a source file column tracking which record came from which file</li>
<li>A <strong>column comparison matrix</strong> showing exactly which columns appear in which files, making structural differences immediately visible</li>
<li>A <strong>file issues report</strong> listing any files with missing sheets, read errors, or empty data</li>
<li>An <strong>interactive pivot table</strong> for exploring the combined data</li>
<li>A <strong>branded Excel download</strong> containing all analysis sheets</li>
</ul>
<p>The app supports <code>.xlsx</code>, <code>.xls</code>, and <code>.csv</code> files, and can handle mixed file types in a single upload.</p>
<section id="why-this-app-exists" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="why-this-app-exists"><span class="header-section-number">8.1</span> Why This App Exists</h2>
<p>Over the past 20 years, I have watched colleagues across public health programs wrestle with this exact task: merging a pile of returned spreadsheets into a single, usable dataset. I have also received enough requests to perform this merge myself that the pattern became impossible to ignore. The task is universal, the pain is real, and the solution is straightforward to automate.</p>
<p>I built this app so that I can share it with colleagues who have little or no programming experience. Rather than walking someone through an R script or doing the merge for them, I can point them to this tool and let them handle it independently.</p>
<div class="callout callout-style-default callout-note callout-titled" title="A Note on GUI Apps and Automation">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>A Note on GUI Apps and Automation
</div>
</div>
<div class="callout-body-container callout-body">
<p>In general, I do not recommend using GUI applications for automated workflows. If a task is recurring, the better investment is a scripted pipeline that runs without manual interaction. However, a point-and-click app like this one earns its place in two situations:</p>
<ul>
<li><strong>Truly one-off requests.</strong> Sometimes you receive a batch of spreadsheets once and will never repeat the exercise. Setting up a project directory, writing a script, and configuring outputs is not justified for a single use.</li>
<li><strong>Quick pre-project checks.</strong> Before committing to a full data pipeline, you may want to take a first look at received files: Are the columns consistent? Are there empty submissions? How many records came back? This app provides that structural overview in seconds, helping you decide how to proceed.</li>
</ul>
<p>For anything that will be repeated on a schedule, build a script.</p>
</div>
</div>
</section>
<section id="why-local-first-sharing" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="why-local-first-sharing"><span class="header-section-number">8.2</span> Why Local-First Sharing?</h2>
<p><a href="https://shiny.posit.co/" target="_blank">Shiny</a> applications can be shared in <a href="https://shiny.posit.co/r/getstarted/shiny-basics/lesson7/" target="_blank">several ways</a>: as hosted web applications on <a href="https://www.shinyapps.io/" target="_blank">shinyapps.io</a>, on a <a href="https://posit.co/products/open-source/shinyserver/" target="_blank">Shiny Server</a>, or as source files that users run locally. I explicitly chose local-first distribution for this app because of the data it handles.</p>
<p>Public health spreadsheets frequently contain protected health information (PHI), personally identifiable information (PII), or other sensitive data. Hosting this app as a public webpage would invite users to upload that data to an external server, which creates unnecessary risk and may violate organizational data governance policies. By distributing the app as source code that runs on the user’s own machine, no data ever leaves the local environment.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hosting with Posit Connect">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Hosting with Posit Connect
</div>
</div>
<div class="callout-body-container callout-body">
<p>If your organization wants to make this app available to a team internally, <a href="https://posit.co/products/enterprise/connect/" target="_blank">Posit Connect</a> is a publishing platform that supports Shiny applications with enterprise features:</p>
<ul>
<li>Password authentication</li>
<li>SSL support</li>
<li>Administrator tools</li>
<li>Priority support</li>
</ul>
<p>Posit Connect allows you to publish Shiny applications, R Markdown reports, dashboards, Jupyter Notebooks, and more in a centralized, access-controlled environment. You can publish directly from the RStudio IDE and configure flexible security policies to control who can access the app.</p>
<p>This is a good option for teams working in a for-profit or regulated setting where centralized access control and audit trails are required. Learn more at <a href="https://posit.co/products/enterprise/connect/" target="_blank">posit.co/products/enterprise/connect</a>.</p>
</div>
</div>
</section>
<section id="user-story" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="user-story"><span class="header-section-number">8.3</span> User Story</h2>
<blockquote class="blockquote">
<p><strong>As a</strong> public health data coordinator who collects Excel-based data from multiple sites, <strong>I want</strong> a tool that automatically combines spreadsheets and flags structural differences, <strong>so that</strong> I can spend my time on analysis instead of copy-pasting and troubleshooting column mismatches.</p>
</blockquote>
</section>
<section id="gps-given-person-should" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="gps-given-person-should"><span class="header-section-number">8.4</span> GPS (Given-Person-Should)</h2>
<blockquote class="blockquote">
<p><strong>Given</strong> a set of Excel workbooks returned by multiple respondents using a common template, <strong>the</strong> data coordinator <strong>should</strong> upload them to the Combine &amp; Compare app and review the column comparison matrix <strong>to</strong> identify and resolve structural inconsistencies before combining the data for analysis.</p>
</blockquote>
</section>
</section>
<section id="getting-started" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Getting Started</h1>
<section id="download-the-app" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="download-the-app"><span class="header-section-number">9.1</span> Download the App</h2>
<p>The app is available in the Public Health Automation Clinic GitHub repository:</p>
<ol type="1">
<li><strong>Download the app folder</strong> from the repository:
<ul>
<li>Go to <a href="https://github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic" target="_blank">github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic</a></li>
<li>Navigate to <code>apps/combine-and-compare-spreadsheets/</code></li>
<li>Download the entire folder (or clone the full repository)</li>
</ul></li>
<li><strong>Clone the full repository</strong> (recommended if you use Git):</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic.git</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The app files are located at <code>apps/combine-and-compare-spreadsheets/</code> within the repository.</p>
</section>
<section id="install-requirements" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="install-requirements"><span class="header-section-number">9.2</span> Install Requirements</h2>
<p>The app requires <a href="https://cran.r-project.org/" target="_blank">R</a> (version 4.1 or later) and the following packages:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"shiny"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bslib"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readxl"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"openxlsx"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DT"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"purrr"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tibble"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rpivotTable"</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="https://posit.co/download/rstudio-desktop/" target="_blank">RStudio Desktop</a> (free) is the recommended IDE for running the app, though any R environment will work.</p>
</section>
<section id="run-the-app" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="run-the-app"><span class="header-section-number">9.3</span> Run the App</h2>
<p>Open <code>app.R</code> in RStudio and click <strong>Run App</strong>, or run the following from an R console:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"apps"</span>, <span class="st">"combine-and-compare-spreadsheets"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The app will open in your default web browser. Everything runs locally on your machine; no data leaves your computer.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/01-about-page.png" class="img-fluid figure-img" alt="Screenshot of the Combine and Compare Spreadsheets app About page showing the app description and feature overview."></p>
<figcaption>The About page introduces the app, explains its purpose, and lists the key features.</figcaption>
</figure>
</div>
</section>
</section>
<section id="how-to-use-the-app" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> How to Use the App</h1>
<section id="step-1-upload-files" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="step-1-upload-files"><span class="header-section-number">10.1</span> Step 1: Upload Files</h2>
<p>Click <strong>Upload Spreadsheets</strong> in the sidebar and select one or more Excel (<code>.xlsx</code>, <code>.xls</code>) or CSV (<code>.csv</code>) files. You can upload a mix of file types in a single batch.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/02-workbench-empty.png" class="img-fluid figure-img" alt="Screenshot of the empty Workbench tab with the file upload control and processing options visible in the sidebar."></p>
<figcaption>The Workbench tab before any files are uploaded, showing the file upload area and processing controls.</figcaption>
</figure>
</div>
</section>
<section id="step-2-select-sheet-name" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="step-2-select-sheet-name"><span class="header-section-number">10.2</span> Step 2: Select Sheet Name</h2>
<p>For Excel files, the app reads all available sheet names across uploaded workbooks and presents them in a dropdown. Select the sheet containing the data you want to combine. CSV files do not require sheet selection.</p>
</section>
<section id="step-3-set-the-header-row" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="step-3-set-the-header-row"><span class="header-section-number">10.3</span> Step 3: Set the Header Row</h2>
<p>If your spreadsheets have title rows, instructions, or logos above the actual column headers, set the <strong>Header Row</strong> to the row number where headers appear. The default is row 1.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/03-files-uploaded.png" class="img-fluid figure-img" alt="Screenshot showing five uploaded Excel files listed in the sidebar with sheet name dropdown and header row selector."></p>
<figcaption>After uploading five county spreadsheets, the sidebar shows the selected sheet name and header row settings.</figcaption>
</figure>
</div>
</section>
<section id="step-4-process-files" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="step-4-process-files"><span class="header-section-number">10.4</span> Step 4: Process Files</h2>
<p>Click <strong>Process Files</strong>. The app will:</p>
<ol type="1">
<li>Read data from each file using the selected sheet name and header row</li>
<li>Clean and standardize column names (lowercase, underscores, consistent formatting)</li>
<li>Add a <code>source_file</code> column to track the origin of each record</li>
<li>Combine all data into a single dataset</li>
<li>Build a column comparison matrix</li>
<li>Log any file issues (missing sheets, read errors, empty data)</li>
</ol>
<p>A progress bar shows status during processing.</p>
</section>
<section id="step-5-review-results" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="step-5-review-results"><span class="header-section-number">10.5</span> Step 5: Review Results</h2>
<p>The Workbench tab provides four views:</p>
<section id="combined-data" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="combined-data"><span class="header-section-number">10.5.1</span> Combined Data</h3>
<p>The full merged dataset with all records from all files. Use the column filters to search and sort. The <code>source_file</code> column identifies which file each record came from.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/04-combined-data.png" class="img-fluid figure-img" alt="Screenshot of the Combined Data tab displaying a merged dataset with columns from all uploaded files and a source_file tracking column."></p>
<figcaption>The Combined Data view showing all records merged into a single table with the source_file column.</figcaption>
</figure>
</div>
</section>
<section id="column-comparison" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="column-comparison"><span class="header-section-number">10.5.2</span> Column Comparison</h3>
<p>The Column Comparison tab contains three sub-views, designed to scale from a handful of files to hundreds:</p>
<section id="discrepancies-only" class="level4" data-number="10.5.2.1">
<h4 data-number="10.5.2.1" class="anchored" data-anchor-id="discrepancies-only"><span class="header-section-number">10.5.2.1</span> Discrepancies Only</h4>
<p>The default and most compact view. Shows <strong>only columns that are not present in every file</strong>. For each mismatched column you can see:</p>
<ul>
<li>How many files contain it and how many are missing it</li>
<li>The percentage of files where it appears</li>
<li>The exact filenames that are missing the column</li>
</ul>
<p>If all files have identical column structures, this view shows a green “no discrepancies” message and an empty table. This is the view to check first: if it is empty, your data is structurally consistent and you can proceed directly to analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/05-discrepancies.png" class="img-fluid figure-img" alt="Screenshot of the Discrepancies Only sub-tab showing a table of columns with mismatches across files, including file counts and missing file names."></p>
<figcaption>The Discrepancies Only view highlighting columns that are not present in every file.</figcaption>
</figure>
</div>
</section>
<section id="full-matrix" class="level4" data-number="10.5.2.2">
<h4 data-number="10.5.2.2" class="anchored" data-anchor-id="full-matrix"><span class="header-section-number">10.5.2.2</span> Full Matrix</h4>
<p>A complete presence/absence matrix with <strong>files as rows</strong> and <strong>column names as headers</strong>:</p>
<ul>
<li><strong>✓</strong> (teal) indicates the column is present in that file</li>
<li><strong>✗</strong> (red) indicates the column is missing from that file</li>
<li>The <code>columns_present</code> and <code>columns_missing</code> summary columns appear at the end of each row</li>
<li>The file column is frozen so it stays visible while scrolling horizontally</li>
<li>Files with more missing columns sort to the top</li>
</ul>
<p>This layout scales better than column-per-file because typical datasets have 10 to 50 columns (manageable as table headers) while file counts can grow to hundreds or thousands (which work well as scrollable rows). For very large uploads, use the Excel download to filter and search the matrix in Excel.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/06-full-matrix.png" class="img-fluid figure-img" alt="Screenshot of the Full Matrix sub-tab showing a file-by-column presence/absence grid with teal check marks and red X marks."></p>
<figcaption>The Full Matrix view with files as rows and columns as headers, using check marks and X marks to show presence and absence.</figcaption>
</figure>
</div>
</section>
<section id="file-profiles" class="level4" data-number="10.5.2.3">
<h4 data-number="10.5.2.3" class="anchored" data-anchor-id="file-profiles"><span class="header-section-number">10.5.2.3</span> File Profiles</h4>
<p>A per-file summary showing:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Column</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rows</td>
<td style="text-align: left;">Number of data rows in the file</td>
</tr>
<tr class="even">
<td style="text-align: left;">Columns</td>
<td style="text-align: left;">Number of columns in the file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected</td>
<td style="text-align: left;">Number of “expected” columns (those present in more than half of all files)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Missing</td>
<td style="text-align: left;">How many expected columns are absent from this file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Missing Columns</td>
<td style="text-align: left;">Semicolon-separated list of which expected columns are missing</td>
</tr>
<tr class="even">
<td style="text-align: left;">Extra</td>
<td style="text-align: left;">How many columns this file has that are not in the expected set</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extra Columns</td>
<td style="text-align: left;">Semicolon-separated list of non-standard columns added to this file</td>
</tr>
</tbody>
</table>
<p>Files with more missing or extra columns sort to the top, making it easy to spot outliers that need manual correction before analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/07-file-profiles.png" class="img-fluid figure-img" alt="Screenshot of the File Profiles sub-tab showing a per-file summary table with rows, columns, expected, missing, and extra column counts."></p>
<figcaption>The File Profiles view summarizing each file’s row count, column count, and any missing or extra columns.</figcaption>
</figure>
</div>
</section>
</section>
<section id="file-issues" class="level3" data-number="10.5.3">
<h3 data-number="10.5.3" class="anchored" data-anchor-id="file-issues"><span class="header-section-number">10.5.3</span> File Issues</h3>
<p>This tab is separate from column discrepancies. It lists files that <strong>could not be processed at all</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 57%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Issue Type</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Missing Sheet</td>
<td style="text-align: left;">The selected sheet name was not found in the workbook</td>
</tr>
<tr class="even">
<td style="text-align: left;">Read Error</td>
<td style="text-align: left;">The file could not be read (corrupt, password-protected, or unsupported format)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Empty Data</td>
<td style="text-align: left;">The file or sheet contained no data rows after the header</td>
</tr>
</tbody>
</table>
<p>If all files processed successfully, this tab shows “All files processed successfully.” Files listed here are excluded from the combined dataset and from the column comparison.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/08-file-issues.png" class="img-fluid figure-img" alt="Screenshot of the File Issues tab showing a table of files with processing problems such as missing sheets or read errors."></p>
<figcaption>The File Issues tab listing files that could not be processed, with issue type descriptions.</figcaption>
</figure>
</div>
</section>
<section id="explore-data" class="level3" data-number="10.5.4">
<h3 data-number="10.5.4" class="anchored" data-anchor-id="explore-data"><span class="header-section-number">10.5.4</span> Explore Data</h3>
<p>An interactive pivot table (<a href="https://github.com/smartinsightsfromdata/rpivotTable" target="_blank">rpivotTable</a>) for ad-hoc exploration of the combined data. Drag columns into rows, columns, or filters to create cross-tabulations, charts, and summaries without writing code.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/images/04a-combine-compare/09-explore-data.png" class="img-fluid figure-img" alt="Screenshot of the Explore Data tab showing the rpivotTable interface with drag-and-drop column fields for building cross-tabulations."></p>
<figcaption>The Explore Data tab with an interactive pivot table for ad-hoc analysis of the combined dataset.</figcaption>
</figure>
</div>
</section>
</section>
<section id="step-6-download" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="step-6-download"><span class="header-section-number">10.6</span> Step 6: Download</h2>
<p>Click <strong>Download Combined XLSX</strong> to export a formatted Excel workbook with five sheets:</p>
<ol type="1">
<li><strong>Combined Data</strong>: the full merged dataset</li>
<li><strong>Discrepancies</strong>: only the mismatched columns (empty if all files match)</li>
<li><strong>Column Matrix</strong>: the full file-by-column presence/absence matrix</li>
<li><strong>File Profiles</strong>: per-file row/column counts with missing and extra columns listed</li>
<li><strong>File Issues</strong>: the processing issue log</li>
</ol>
<p>The workbook uses professional formatting with styled headers. The <strong>Discrepancies</strong> and <strong>File Profiles</strong> sheets are particularly useful for filtering and searching in Excel when dealing with hundreds of files.</p>
</section>
</section>
<section id="supported-file-formats" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Supported File Formats</h1>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Format</th>
<th style="text-align: left;">Extension</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Excel (modern)</td>
<td style="text-align: left;"><code>.xlsx</code></td>
<td style="text-align: left;">Full support including sheet selection</td>
</tr>
<tr class="even">
<td style="text-align: left;">Excel (legacy)</td>
<td style="text-align: left;"><code>.xls</code></td>
<td style="text-align: left;">Full support including sheet selection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CSV</td>
<td style="text-align: left;"><code>.csv</code></td>
<td style="text-align: left;">Sheet selection is not applicable</td>
</tr>
</tbody>
</table>
<p>Mixed file types can be uploaded together. For example, you can upload eight <code>.xlsx</code> files and two <code>.csv</code> files in the same batch.</p>
</section>
<section id="tips-and-best-practices" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Tips and Best Practices</h1>
<div class="callout callout-style-default callout-tip callout-titled" title="Preventing Problems at the Source">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Preventing Problems at the Source
</div>
</div>
<div class="callout-body-container callout-body">
<p>The best way to handle column mismatches is to prevent them. When distributing data collection templates:</p>
<ul>
<li><strong>Lock the header row</strong> in Excel (Review &gt; Protect Sheet, allow only data entry in the data range)</li>
<li><strong>Use data validation</strong> on key columns to constrain inputs</li>
<li><strong>Name your sheets consistently</strong> and include instructions not to rename them</li>
<li><strong>Include a “do not modify” note</strong> in the template header</li>
</ul>
<p>The Combine &amp; Compare app is most valuable when prevention was not possible, which, in practice, is most of the time.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Large File Uploads">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Large File Uploads
</div>
</div>
<div class="callout-body-container callout-body">
<p>The app supports uploads up to 100 MB total. For very large collections of spreadsheets, consider processing them in batches and combining the downloaded outputs.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Local-First">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Local-First
</div>
</div>
<div class="callout-body-container callout-body">
<p>This app runs entirely on your local machine. No data is uploaded to external servers. This makes it suitable for use with protected health information (PHI) and other sensitive data, subject to your organization’s policies for running local software.</p>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/04-data-cleaning-transformation.html" class="pagination-link" aria-label="Data Cleaning and Transformation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Cleaning and Transformation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/05-data-analysis-reporting.html" class="pagination-link" aria-label="Data Analysis and Reporting">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Analysis and Reporting</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Combine and Compare Spreadsheets"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Problem</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Public health teams frequently distribute Excel-based data collection forms to multiple sites, facilities, or respondents. A common workflow looks like this: a program coordinator creates a standardized spreadsheet template, emails it to ten county offices, and asks each office to fill in their data and return it. Sometimes the spreadsheets are stored in a shared folder instead. Either way, the coordinator eventually needs to combine all responses into a single dataset for analysis.</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>This process breaks down in predictable ways:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Column headers get renamed.** One site changes "date_of_diagnosis" to "dx_date." Another adds a space. A third capitalizes it differently.</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Columns are added or removed.** A site inserts an extra column for local tracking, or deletes a column they consider irrelevant.</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sheet names differ.** The template uses "Data Entry" but a respondent renames the tab to "Sheet1."</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Manual merging is tedious and error-prone.** Copy-pasting rows from ten spreadsheets into a master file can take hours and risks misaligned columns, dropped records, or duplicated data.</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>The coordinator may then try to analyze the combined data in Excel or R, only to discover that the structural inconsistencies have created problems downstream: mismatched column counts, unexpected blanks, or silently misaligned values.</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Why Not Use a Proper Data Collection Tool?"}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>If you have the option, a structured data collection platform like <span class="co">[</span><span class="ot">REDCap</span><span class="co">](https://www.project-redcap.org/)</span>{target="_blank"}, <span class="co">[</span><span class="ot">KoBoToolbox</span><span class="co">](https://www.kobotoolbox.org/)</span>{target="_blank"}, or even <span class="co">[</span><span class="ot">Google Forms</span><span class="co">](https://www.google.com/forms/about/)</span>{target="_blank"} is almost always preferable to distributing Excel templates. These tools enforce field types, validation rules, and consistent structure at the point of entry, eliminating the column mismatch problem entirely.</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>However, many public health teams still end up with spreadsheets for practical reasons:</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**No access to REDCap or similar tools.** Not every organization has a REDCap instance, and setting one up requires server infrastructure and IRB coordination.</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Speed of setup.** Creating an Excel template and emailing it takes minutes. Configuring a REDCap instrument with branching logic and validation can take days.</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Existing systems export spreadsheets.** Cancer registries, laboratory information systems, EHR extracts, and surveillance platforms often produce Excel or CSV exports as their standard output format. The data was never "collected" in a spreadsheet; it was generated by another system.</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**External partners use Excel.** When collecting data from facilities, providers, or agencies outside your organization, you often cannot dictate the tool. You get what you get.</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One-time or ad-hoc collections.** For a quick data call that will only happen once, the overhead of setting up a formal data collection instrument may not be justified.</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>This tool is designed for those situations: when spreadsheets are the reality, whether by choice or by circumstance.</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Scale of the Problem</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>Consider a state cancer registry that collects annual data submissions from 88 county health departments using a standardized Excel template. Each year, staff must:</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Download or receive 88 completed workbooks</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Open each one to verify the correct sheet exists</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Check that column headers match the template</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Copy and paste (or append) the data into a master file</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Troubleshoot the files that do not match</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>At 5 to 10 minutes per file, this is 7 to 15 hours of manual work, repeated every reporting cycle. And that estimate assumes nothing goes wrong.</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Solution</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>The **Combine &amp; Compare Spreadsheets** app is a Shiny web application that automates this entire workflow. Upload your spreadsheets, click a button, and get:</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A **combined dataset** with a source file column tracking which record came from which file</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A **column comparison matrix** showing exactly which columns appear in which files, making structural differences immediately visible</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A **file issues report** listing any files with missing sheets, read errors, or empty data</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>An **interactive pivot table** for exploring the combined data</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A **branded Excel download** containing all analysis sheets</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>The app supports <span class="in">`.xlsx`</span>, <span class="in">`.xls`</span>, and <span class="in">`.csv`</span> files, and can handle mixed file types in a single upload.</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why This App Exists</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>Over the past 20 years, I have watched colleagues across public health programs wrestle with this exact task: merging a pile of returned spreadsheets into a single, usable dataset. I have also received enough requests to perform this merge myself that the pattern became impossible to ignore. The task is universal, the pain is real, and the solution is straightforward to automate.</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>I built this app so that I can share it with colleagues who have little or no programming experience. Rather than walking someone through an R script or doing the merge for them, I can point them to this tool and let them handle it independently.</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="A Note on GUI Apps and Automation"}</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>In general, I do not recommend using GUI applications for automated workflows. If a task is recurring, the better investment is a scripted pipeline that runs without manual interaction. However, a point-and-click app like this one earns its place in two situations:</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Truly one-off requests.** Sometimes you receive a batch of spreadsheets once and will never repeat the exercise. Setting up a project directory, writing a script, and configuring outputs is not justified for a single use.</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Quick pre-project checks.** Before committing to a full data pipeline, you may want to take a first look at received files: Are the columns consistent? Are there empty submissions? How many records came back? This app provides that structural overview in seconds, helping you decide how to proceed.</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>For anything that will be repeated on a schedule, build a script.</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why Local-First Sharing?</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Shiny</span><span class="co">](https://shiny.posit.co/)</span>{target="_blank"} applications can be shared in <span class="co">[</span><span class="ot">several ways</span><span class="co">](https://shiny.posit.co/r/getstarted/shiny-basics/lesson7/)</span>{target="_blank"}: as hosted web applications on <span class="co">[</span><span class="ot">shinyapps.io</span><span class="co">](https://www.shinyapps.io/)</span>{target="_blank"}, on a <span class="co">[</span><span class="ot">Shiny Server</span><span class="co">](https://posit.co/products/open-source/shinyserver/)</span>{target="_blank"}, or as source files that users run locally. I explicitly chose local-first distribution for this app because of the data it handles.</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>Public health spreadsheets frequently contain protected health information (PHI), personally identifiable information (PII), or other sensitive data. Hosting this app as a public webpage would invite users to upload that data to an external server, which creates unnecessary risk and may violate organizational data governance policies. By distributing the app as source code that runs on the user's own machine, no data ever leaves the local environment.</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Hosting with Posit Connect"}</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>If your organization wants to make this app available to a team internally, <span class="co">[</span><span class="ot">Posit Connect</span><span class="co">](https://posit.co/products/enterprise/connect/)</span>{target="_blank"} is a publishing platform that supports Shiny applications with enterprise features:</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Password authentication</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SSL support</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Administrator tools</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Priority support</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>Posit Connect allows you to publish Shiny applications, R Markdown reports, dashboards, Jupyter Notebooks, and more in a centralized, access-controlled environment. You can publish directly from the RStudio IDE and configure flexible security policies to control who can access the app.</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>This is a good option for teams working in a for-profit or regulated setting where centralized access control and audit trails are required. Learn more at <span class="co">[</span><span class="ot">posit.co/products/enterprise/connect</span><span class="co">](https://posit.co/products/enterprise/connect/)</span>{target="_blank"}.</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## User Story</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **As a** public health data coordinator who collects Excel-based data from multiple sites,</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **I want** a tool that automatically combines spreadsheets and flags structural differences,</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **so that** I can spend my time on analysis instead of copy-pasting and troubleshooting column mismatches.</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## GPS (Given-Person-Should)</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Given** a set of Excel workbooks returned by multiple respondents using a common template,</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **the** data coordinator **should** upload them to the Combine &amp; Compare app and review the column comparison matrix</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **to** identify and resolve structural inconsistencies before combining the data for analysis.</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Getting Started</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Download the App</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>The app is available in the Public Health Automation Clinic GitHub repository:</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Download the app folder** from the repository:</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Go to <span class="co">[</span><span class="ot">github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic</span><span class="co">](https://github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic)</span>{target="_blank"}</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Navigate to <span class="in">`apps/combine-and-compare-spreadsheets/`</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Download the entire folder (or clone the full repository)</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Clone the full repository** (recommended if you use Git):</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/andre-inter-collab-llc/Public-Health-Automation-Clinic.git</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>The app files are located at <span class="in">`apps/combine-and-compare-spreadsheets/`</span> within the repository.</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a><span class="fu">## Install Requirements</span></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>The app requires <span class="co">[</span><span class="ot">R</span><span class="co">](https://cran.r-project.org/)</span>{target="_blank"} (version 4.1 or later) and the following packages:</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>  <span class="st">"shiny"</span>,</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bslib"</span>,</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readxl"</span>,</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>,</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>,</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>  <span class="st">"openxlsx"</span>,</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DT"</span>,</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>,</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>  <span class="st">"purrr"</span>,</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tibble"</span>,</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rpivotTable"</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">RStudio Desktop</span><span class="co">](https://posit.co/download/rstudio-desktop/)</span>{target="_blank"} (free) is the recommended IDE for running the app, though any R environment will work.</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run the App</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>Open <span class="in">`app.R`</span> in RStudio and click **Run App**, or run the following from an R console:</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runApp</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"apps"</span>, <span class="st">"combine-and-compare-spreadsheets"</span>))</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>The app will open in your default web browser. Everything runs locally on your machine; no data leaves your computer.</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a><span class="al">![The About page introduces the app, explains its purpose, and lists the key features.](../assets/images/04a-combine-compare/01-about-page.png)</span>{fig-alt="Screenshot of the Combine and Compare Spreadsheets app About page showing the app description and feature overview."}</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a><span class="fu"># How to Use the App</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1: Upload Files</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>Click **Upload Spreadsheets** in the sidebar and select one or more Excel (<span class="in">`.xlsx`</span>, <span class="in">`.xls`</span>) or CSV (<span class="in">`.csv`</span>) files. You can upload a mix of file types in a single batch.</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="al">![The Workbench tab before any files are uploaded, showing the file upload area and processing controls.](../assets/images/04a-combine-compare/02-workbench-empty.png)</span>{fig-alt="Screenshot of the empty Workbench tab with the file upload control and processing options visible in the sidebar."}</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 2: Select Sheet Name</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>For Excel files, the app reads all available sheet names across uploaded workbooks and presents them in a dropdown. Select the sheet containing the data you want to combine. CSV files do not require sheet selection.</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 3: Set the Header Row</span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>If your spreadsheets have title rows, instructions, or logos above the actual column headers, set the **Header Row** to the row number where headers appear. The default is row 1.</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a><span class="al">![After uploading five county spreadsheets, the sidebar shows the selected sheet name and header row settings.](../assets/images/04a-combine-compare/03-files-uploaded.png)</span>{fig-alt="Screenshot showing five uploaded Excel files listed in the sidebar with sheet name dropdown and header row selector."}</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 4: Process Files</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>Click **Process Files**. The app will:</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Read data from each file using the selected sheet name and header row</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Clean and standardize column names (lowercase, underscores, consistent formatting)</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Add a <span class="in">`source_file`</span> column to track the origin of each record</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Combine all data into a single dataset</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Build a column comparison matrix</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Log any file issues (missing sheets, read errors, empty data)</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>A progress bar shows status during processing.</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 5: Review Results</span></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>The Workbench tab provides four views:</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combined Data</span></span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>The full merged dataset with all records from all files. Use the column filters to search and sort. The <span class="in">`source_file`</span> column identifies which file each record came from.</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a><span class="al">![The Combined Data view showing all records merged into a single table with the source_file column.](../assets/images/04a-combine-compare/04-combined-data.png)</span>{fig-alt="Screenshot of the Combined Data tab displaying a merged dataset with columns from all uploaded files and a source_file tracking column."}</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Column Comparison</span></span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>The Column Comparison tab contains three sub-views, designed to scale from a handful of files to hundreds:</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Discrepancies Only</span></span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>The default and most compact view. Shows **only columns that are not present in every file**. For each mismatched column you can see:</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How many files contain it and how many are missing it</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The percentage of files where it appears</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The exact filenames that are missing the column</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>If all files have identical column structures, this view shows a green "no discrepancies" message and an empty table. This is the view to check first: if it is empty, your data is structurally consistent and you can proceed directly to analysis.</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a><span class="al">![The Discrepancies Only view highlighting columns that are not present in every file.](../assets/images/04a-combine-compare/05-discrepancies.png)</span>{fig-alt="Screenshot of the Discrepancies Only sub-tab showing a table of columns with mismatches across files, including file counts and missing file names."}</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Full Matrix</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>A complete presence/absence matrix with **files as rows** and **column names as headers**:</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**✓** (teal) indicates the column is present in that file</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**✗** (red) indicates the column is missing from that file</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`columns_present`</span> and <span class="in">`columns_missing`</span> summary columns appear at the end of each row</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The file column is frozen so it stays visible while scrolling horizontally</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Files with more missing columns sort to the top</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>This layout scales better than column-per-file because typical datasets have 10 to 50 columns (manageable as table headers) while file counts can grow to hundreds or thousands (which work well as scrollable rows). For very large uploads, use the Excel download to filter and search the matrix in Excel.</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a><span class="al">![The Full Matrix view with files as rows and columns as headers, using check marks and X marks to show presence and absence.](../assets/images/04a-combine-compare/06-full-matrix.png)</span>{fig-alt="Screenshot of the Full Matrix sub-tab showing a file-by-column presence/absence grid with teal check marks and red X marks."}</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a><span class="fu">#### File Profiles</span></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>A per-file summary showing:</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Column <span class="pp">|</span> Meaning <span class="pp">|</span></span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-------|:--------|</span></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Rows <span class="pp">|</span> Number of data rows in the file <span class="pp">|</span></span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Columns <span class="pp">|</span> Number of columns in the file <span class="pp">|</span></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Expected <span class="pp">|</span> Number of "expected" columns (those present in more than half of all files) <span class="pp">|</span></span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Missing <span class="pp">|</span> How many expected columns are absent from this file <span class="pp">|</span></span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Missing Columns <span class="pp">|</span> Semicolon-separated list of which expected columns are missing <span class="pp">|</span></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Extra <span class="pp">|</span> How many columns this file has that are not in the expected set <span class="pp">|</span></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Extra Columns <span class="pp">|</span> Semicolon-separated list of non-standard columns added to this file <span class="pp">|</span></span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>Files with more missing or extra columns sort to the top, making it easy to spot outliers that need manual correction before analysis.</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a><span class="al">![The File Profiles view summarizing each file's row count, column count, and any missing or extra columns.](../assets/images/04a-combine-compare/07-file-profiles.png)</span>{fig-alt="Screenshot of the File Profiles sub-tab showing a per-file summary table with rows, columns, expected, missing, and extra column counts."}</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### File Issues</span></span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>This tab is separate from column discrepancies. It lists files that **could not be processed at all**:</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Issue Type <span class="pp">|</span> Meaning <span class="pp">|</span></span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-----------|:--------|</span></span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Missing Sheet <span class="pp">|</span> The selected sheet name was not found in the workbook <span class="pp">|</span></span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Read Error <span class="pp">|</span> The file could not be read (corrupt, password-protected, or unsupported format) <span class="pp">|</span></span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Empty Data <span class="pp">|</span> The file or sheet contained no data rows after the header <span class="pp">|</span></span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>If all files processed successfully, this tab shows "All files processed successfully." Files listed here are excluded from the combined dataset and from the column comparison.</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a><span class="al">![The File Issues tab listing files that could not be processed, with issue type descriptions.](../assets/images/04a-combine-compare/08-file-issues.png)</span>{fig-alt="Screenshot of the File Issues tab showing a table of files with processing problems such as missing sheets or read errors."}</span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### Explore Data</span></span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>An interactive pivot table (<span class="co">[</span><span class="ot">rpivotTable</span><span class="co">](https://github.com/smartinsightsfromdata/rpivotTable)</span>{target="_blank"}) for ad-hoc exploration of the combined data. Drag columns into rows, columns, or filters to create cross-tabulations, charts, and summaries without writing code.</span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a><span class="al">![The Explore Data tab with an interactive pivot table for ad-hoc analysis of the combined dataset.](../assets/images/04a-combine-compare/09-explore-data.png)</span>{fig-alt="Screenshot of the Explore Data tab showing the rpivotTable interface with drag-and-drop column fields for building cross-tabulations."}</span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 6: Download</span></span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>Click **Download Combined XLSX** to export a formatted Excel workbook with five sheets:</span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Combined Data**: the full merged dataset</span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Discrepancies**: only the mismatched columns (empty if all files match)</span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Column Matrix**: the full file-by-column presence/absence matrix</span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**File Profiles**: per-file row/column counts with missing and extra columns listed</span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**File Issues**: the processing issue log</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>The workbook uses professional formatting with styled headers. The **Discrepancies** and **File Profiles** sheets are particularly useful for filtering and searching in Excel when dealing with hundreds of files.</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a><span class="fu"># Supported File Formats</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Format <span class="pp">|</span> Extension <span class="pp">|</span> Notes <span class="pp">|</span></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-------|:----------|:------|</span></span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Excel (modern) <span class="pp">|</span> <span class="in">`.xlsx`</span> <span class="pp">|</span> Full support including sheet selection <span class="pp">|</span></span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Excel (legacy) <span class="pp">|</span> <span class="in">`.xls`</span> <span class="pp">|</span> Full support including sheet selection <span class="pp">|</span></span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> CSV <span class="pp">|</span> <span class="in">`.csv`</span> <span class="pp">|</span> Sheet selection is not applicable <span class="pp">|</span></span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>Mixed file types can be uploaded together. For example, you can upload eight <span class="in">`.xlsx`</span> files and two <span class="in">`.csv`</span> files in the same batch.</span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a><span class="fu"># Tips and Best Practices</span></span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Preventing Problems at the Source"}</span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>The best way to handle column mismatches is to prevent them. When distributing data collection templates:</span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lock the header row** in Excel (Review &gt; Protect Sheet, allow only data entry in the data range)</span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Use data validation** on key columns to constrain inputs</span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Name your sheets consistently** and include instructions not to rename them</span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Include a "do not modify" note** in the template header</span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>The Combine &amp; Compare app is most valuable when prevention was not possible, which, in practice, is most of the time.</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Large File Uploads"}</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>The app supports uploads up to 100 MB total. For very large collections of spreadsheets, consider processing them in batches and combining the downloaded outputs.</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Local-First"}</span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>This app runs entirely on your local machine. No data is uploaded to external servers. This makes it suitable for use with protected health information (PHI) and other sensitive data, subject to your organization's policies for running local software.</span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>:::</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>